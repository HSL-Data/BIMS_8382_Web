---
title: "Viz Homework"
output:
  pdf_document: default
  html_document:
    df_print: paged
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, echo = FALSE, warning = FALSE, message = FALSE}
library(tidyverse)
hd <- read_csv("Data/heart_disease.csv")
```

##Instructions
The goal of this homework is to recreate a series of graphs in ggplot2. Do not worry about matching up the colors/sizes, etc perfectly, but try and ensure that the graph type, labels, and disparate categories all match up.

##Before you start:

Read in the heart disease dataset and read over the codebook to understand the variables.

#Exercise 1

Reproduce the follow graph that is looking at the relationship between age and resting blood pressure.


```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.fullwidth=TRUE, fig.width=10, fig.height=6}
p <- ggplot(hd, aes(x = age, y = trestbps))
p + geom_smooth(size = 2)

```


#Exercise 2

Reproduce the following graph that is looking at the relationship between resting blood pressure and cholestorol by outcome.


```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.fullwidth=TRUE, fig.width=10, fig.height=6}
p <- ggplot(hd, aes(x = trestbps, y = chol))
p + geom_point(aes(color = outcome), size = 2, pch = 4)
```

#Exercise 3

Reproduce the following graphs looking at the relationship maximum heart rate achieved and cholestorol, Faceted by chest pain type (cp = 1, 2, 3 or 4)


```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.fullwidth=TRUE, fig.width=10, fig.height=6}
p <- ggplot(hd, aes(thalach, chol)) 
p + geom_smooth() + geom_point(aes(color = outcome)) + facet_wrap(~cp, ncol = 4)
```

```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.fullwidth=TRUE, fig.width=10, fig.height=6}
p <- ggplot(filter(hd,cp > 1 & cp < 4), aes(thalach, chol)) 
p + geom_smooth() + geom_point(aes(color = outcome)) + facet_wrap(~cp, ncol = 1)
```


#Exercise 4

Reproduce this graph looking at the relationship between outcome and age. 
Make sure to check the legend, axis, etc.


```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.fullwidth=TRUE, fig.width=10, fig.height=6}
p <- ggplot(hd, aes(x = outcome, y = age)) 
p + geom_boxplot() + geom_jitter(aes(color = sex)) + ggtitle("Age vs. Outcome by Sex") +  xlab("Heart Disease Outcome") + ylab("Age (years)")
```

#Exercise 5

Reproduce the following graphs looking at the maximum heart rate achieved by chest pain type.
Hint: Change cp to a factor `hd$cp <- as.factor(hd$cp)`


```{r, echo = FALSE, warning = FALSE, message = FALSE, fig.fullwidth=TRUE, fig.width=10, fig.height=6}
hd$cp <- as.factor(hd$cp)
p <- ggplot(hd, aes(thalach))
p + geom_density(aes(color = cp, fill = cp), alpha = 1/4) + geom_vline(xintercept = c(100, 150), size = 2, color = c("firebrick", "blue"), alpha = 1/4) + geom_hline(yintercept = c(.005, .020), size = 3, color = c("green", "yellow"), alpha = 1/4) + xlab("Maximum Heart Rate Achieved") + ggtitle("Distribution of Maximum Heart Rate Achieved by Chest Pain Type")

```

```{r, echo = FALSE, warning = FALSE, message = FALSE,fig.fullwidth=TRUE, fig.width=10, fig.height=6}
p <- ggplot(hd, aes(thalach))
p + geom_density(aes(color = cp, fill = cp)) + xlab("Maximum Heart Rate Achieved") + ggtitle("Distribution of Maximum Heart Rate Achieved by Chest Pain Type") + facet_wrap(aes(cp))
```
